# GitIngest Agent

Automated GitHub repository analysis tool using GitIngest CLI and Claude Code.

## Status

**Phase:** 1 - Core Clone ✅ **COMPLETE**
- ✅ Explore Phase: Research complete
- ✅ Plan Phase: PRD & Architecture complete
- ✅ Story Creation: 13 stories generated by SM agent
- ✅ Project Setup: UV project initialized
- ✅ Execute Phase: All 13 stories implemented
- ✅ Testing: 190 tests passing, 96%+ coverage
- ✅ Documentation: Complete story records and workflow automation

## Overview

GitIngest Agent eliminates manual friction in analyzing GitHub repositories by:
- **Automatic token size checking** (200k threshold)
- **Intelligent workflow routing** (full vs selective extraction)
- **Claude Code integration** via CLAUDE.md automation
- **Structured analysis storage** for future reference

### Key Features (Phase 1)

1. **Token Size Checking** - Automatic repository token counting
2. **Full Extraction** - Complete repository content for repos < 200k tokens
3. **Selective Extraction** - Targeted content extraction for repos >= 200k tokens
4. **Size Re-Check** - Prevents token overflow after selective extraction
5. **Analysis Generation** - Installation, workflow, or architecture analysis
6. **Optional Storage** - Save analyses to analyze/ folder

## Technology Stack

- **Python 3.12+** - Core language
- **UV Package Manager** - Fast dependency management
- **Click Framework** - CLI interface
- **GitIngest CLI** - Repository extraction (external tool)
- **BMAD Methodology** - Development workflow

## Project Structure

```
gitingest-agent-project/
├── .bmad-core/              # BMAD framework
├── docs/                    # Planning & story documents
│   ├── prd.md              # Product requirements
│   ├── architecture.md     # System design
│   └── stories/            # Implementation stories (1.2-1.14, all complete)
├── explore/                 # Research documents
├── plan/                    # Planning work
├── user-context/            # User-provided contextual files
├── execute/                 # Implementation directory (all Python code)
│   ├── .venv/              # UV virtual environment
│   ├── tests/              # Test suite (190 tests, 99% coverage)
│   ├── cli.py              # CLI entry point (Click framework)
│   ├── token_counter.py    # Token counting & routing logic
│   ├── workflow.py         # Display formatting utilities
│   ├── storage.py          # File management & analysis storage
│   ├── extractor.py        # GitIngest API wrapper
│   ├── exceptions.py       # Custom exception classes
│   ├── pyproject.toml      # Python project configuration
│   └── uv.lock             # Dependency lock file
├── analyze/                 # Generated analyses storage
├── data/                    # Repository extraction storage
├── CLAUDE.md                # Agent configuration (Claude Code behavior)
├── CLAUDE_ANALYSIS_GUIDE.md # Analysis generation specifications
└── README.md                # This file
```

### Structure Explanation

**Root Level:**
- **BMAD Framework:** `.bmad-core/`, `docs/`, `explore/`, `plan/`, `user-context/`
- **Agent Configuration:** `CLAUDE.md`, `CLAUDE_ANALYSIS_GUIDE.md` (Claude Code runtime config)
- **Project Documentation:** `README.md`

**execute/ Directory:**
- **All Python Implementation:** Source code, tests, and Python environment
- **Self-Contained:** Complete Python project with its own pyproject.toml and .venv
- **Working Directory:** All development commands run from execute/

## Development Setup

### Prerequisites

- Python 3.12 or higher
- UV package manager installed
- GitIngest CLI installed globally (`uv tool install gitingest`)
- Git for version control

### Installation

```bash
# Navigate to project
cd "Software Projects/gitingest-agent-project"

# Navigate to implementation directory
cd execute

# Sync environment (creates .venv and installs dependencies)
uv sync

# Install in development mode
uv pip install -e .

# Verify installation
uv run gitingest-agent --help
uv run pytest --version
```

**Important:** All development commands must be run from the `execute/` directory.

## Development Workflow

This project follows the **BMAD (Breakthrough Method for AI-driven Agile Development)** methodology with integrated QA.

### Phase 1 Complete ✅

All 13 stories (1.2-1.14) implemented using BMAD workflow:

**Completed:**
1. ✅ Story Creation with Scrum Master agent (`@sm *draft`)
2. ✅ Story Implementation with Developer agent (`@dev *develop-story`)
3. ✅ Test-driven development (190 tests, 96%+ coverage)
4. ✅ Comprehensive documentation (story records, workflow automation)

### BMAD Workflow Reference

- **Story Creation**: `@sm *draft` ✅
- **Story Implementation**: `@dev *develop-story {story}` ✅
- **Story Review**: `@qa *review {story}` (Optional)
- **Risk Assessment**: `@qa *risk {story}` (Optional)
- **Test Design**: `@qa *design {story}` (Optional)

See `.bmad-core/enhanced-ide-development-workflow.md` for complete workflow details.

## Testing

All test commands must be run from the `execute/` directory:

```bash
# Navigate to execute directory
cd execute

# Run all tests
uv run pytest

# Run with coverage
uv run pytest --cov

# Run specific test file
uv run pytest tests/test_token_counter.py

# Run with verbose output
uv run pytest -v
```

## CLI Usage

The CLI is fully implemented and ready to use. All commands run from the `execute/` directory:

```bash
# Navigate to execute directory
cd execute

# Check repository token size
uv run gitingest-agent check-size https://github.com/user/repo

# Extract full repository (< 200k tokens)
uv run gitingest-agent extract-full https://github.com/user/repo

# Extract tree structure (>= 200k tokens)
uv run gitingest-agent extract-tree https://github.com/user/repo

# Extract specific content with overflow prevention
uv run gitingest-agent extract-specific https://github.com/user/repo --type docs
uv run gitingest-agent extract-specific https://github.com/user/repo --type installation
uv run gitingest-agent extract-specific https://github.com/user/repo --type code
uv run gitingest-agent extract-specific https://github.com/user/repo --type auto
```

### Automated Workflow

For Claude Code users, simply provide a GitHub URL in your conversation:

```
Analyze https://github.com/user/repo
```

Claude Code will automatically:
1. Check token size
2. Route to appropriate extraction workflow
3. Prompt for analysis type (installation/workflow/architecture/custom)
4. Generate detailed analysis
5. Optionally save to `analyze/` folder

See [CLAUDE.md](CLAUDE.md) for complete workflow automation details.

## Known Issues

### Windows UTF-8 Encoding Errors

**Issue:** GitIngest (external dependency) may fail to read UTF-8 files on Windows, resulting in encoding errors in extracted content.

**Symptoms:**
- Error messages in extracted files: `Error reading file with 'cp1252': 'charmap' codec can't decode byte...`
- Incomplete repository extraction
- Missing content from files with special characters (e.g., emojis, non-ASCII characters)

**Affected Platforms:**
- Windows 11 (all terminals)
- Any Windows system with default cp1252 encoding

**Workarounds:**

1. **Use file output (recommended):**
   ```bash
   # Better than stdout
   uv run gitingest-agent extract-full https://github.com/user/repo
   ```

2. **Try selective extraction:**
   ```bash
   # Extract only installation files (smaller, fewer encoding issues)
   uv run gitingest-agent extract-specific https://github.com/user/repo --type installation
   ```

3. **Manual encoding fix (advanced):**
   - Set `PYTHONIOENCODING=utf-8` environment variable before running
   - Use WSL (Windows Subsystem for Linux) instead of native Windows

**Detection:**
The tool now automatically detects encoding errors and displays warnings like:
```
[WARNING] Encoding errors detected in 3 file(s):
  - README.md
  - docs/guide.md
  - src/utils.py

This is a known GitIngest issue on Windows with UTF-8 files.
```

**Impact:**
- Medium - Affects content quality but doesn't break core functionality
- Extraction continues with available content
- Most files are still readable; only files with special characters are affected

**Status:**
- This is an external GitIngest library issue, not a bug in GitIngest Agent
- We've implemented graceful degradation to detect and warn about encoding errors
- Consider filing an issue with the GitIngest project: https://github.com/cyclotruc/gitingest

**Related:** Issue #7 (Windows encoding issues)

---

## Documentation

- **[PRD](docs/prd.md)** - Product requirements and user stories
- **[Architecture](docs/architecture.md)** - System design and technical details
- **[CLAUDE.md](CLAUDE.md)** - Complete workflow automation guide
- **[CLAUDE_ANALYSIS_GUIDE.md](CLAUDE_ANALYSIS_GUIDE.md)** - Analysis generation specifications
- **[Stories](docs/stories/)** - Implementation stories (1.2-1.14, all complete)
- **[Research](explore/)** - Exploration phase research documents

## Phase Roadmap

### Phase 1: Core Clone ✅ **COMPLETE**
High-fidelity replication of proven design from AI LABS video.

**Implemented Features:**
- ✅ Token size checking and routing (200k threshold)
- ✅ Full and selective extraction workflows
- ✅ Claude Code automation via CLAUDE.md
- ✅ Analysis generation (4 types: installation, workflow, architecture, custom)
- ✅ Analysis storage with metadata headers
- ✅ Token overflow prevention with iterative refinement
- ✅ CLI with 4 commands (check-size, extract-full, extract-tree, extract-specific)
- ✅ 190 tests passing, 96%+ coverage

**Implementation Stats:**
- 13 stories completed (1.2-1.14)
- 5 core modules (cli, token_counter, workflow, storage, extractor)
- 15 files changed, 4,926+ lines added
- Complete documentation and workflow automation

### Phase 1.5: Multi-Location Output (Future)
Enhanced storage capabilities for cross-project usage.

**Planned Features:**
- BMAD project detection
- context/related-repos/ structure
- --output-dir parameter
- Work from any directory

See `user-context/gitingest-agent-requirements-addendum-custom-enhancements.md` for Phase 1.5 details.

## Contributing

This is a personal development project following BMAD methodology. Development is tracked through:
- User stories in `docs/stories/`
- Quality gates via Test Architect (`@qa`)
- Git commits with co-authorship by Claude

## License

(To be determined)

---

**Development Status:** Phase 1 Complete ✅ - Fully functional CLI tool ready for use.

**Next Steps:**
- Test workflow automation with real repositories
- Begin Phase 1.5 planning for enhanced features
- Deploy for production use

> Built with [Claude Code](https://claude.com/claude-code) using BMAD methodology